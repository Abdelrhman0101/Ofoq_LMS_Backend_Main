<?php

namespace Database\Seeders;

use Illuminate\Database\Seeder;
use Illuminate\Support\Str;
use Illuminate\Support\Facades\Schema;
use Illuminate\Support\Facades\Artisan;
use Illuminate\Support\Facades\File;
use App\Models\Course;
use App\Models\Instructors;
use App\Models\CategoryOfCourse;
use App\Models\Chapter;
use App\Models\Lesson;
use App\Models\Quiz;
use App\Models\Question;

class CoursesSeeder extends Seeder
{
    /** حوّل أي قيمة صورة إلى مسار نسبي داخل storage (inst/..). */
    private function normalizeImagePath(?string $path): ?string
    {
        if (!$path) return null;

        $p = Str::of($path);
        if ($p->contains('/storage/')) {
            return ltrim($p->after('/storage/')->toString(), '/');
        }
        return ltrim($path, '/');
    }

    /** تأكد من وجود symlink public/storage → storage/app/public */
    private function ensureStorageLink(): void
    {
        $publicStorage = public_path('storage');
        if (!File::exists($publicStorage)) {
            try {
                Artisan::call('storage:link');
                $this->command?->info('🔗 storage:link created.');
            } catch (\Throwable $e) {
                $this->command?->warn('⚠️ Failed to create storage:link (continuing)...');
            }
        }
    }

    public function run(): void
    {
        $this->ensureStorageLink();

        $courses = [
            [
                'instructor_name' => 'د. عبد الرحمن البسيوني',
                'instructor_description' => 'الخبير الإعلامي بمعهد الإذاعة والتلفزيون',
                'instructor_image' => 'https://api.ofuq.academy/storage/inst/dr.abdelrhman-elbasweny.jpg',
                'title' => 'مبادئ ونظريات الإدارة للمؤسسات الإعلامية',
                'category_name' => 'الإدارة الإعلامية',
                'is_featured' => true,
                'course_description' => 'تُعَدّ القيادة في المؤسسات الإعلامية ركيزة أساسية في نجاح العمل المؤسسي وتحقيق الأهداف التنظيمية بكفاءة وفاعلية. إذ تلعب القيادة دورًا محوريًا في توجيه فرق العمل، وتنظيم الجهود، وتعزيز روح التعاون والثقة بين العاملين على اختلاف مستوياتهم ومهامهم. فالمؤسسات الإعلامية، شأنها شأن سائر المؤسسات، تحتاج إلى قيادات واعية تمتلك القدرة على التخطيط واتخاذ القرار والإشراف والمتابعة، بما يضمن تحقيق رسالتها الإعلامية ومواكبتها للتطورات المهنية والتقنية. وفي ظل التحولات السريعة التي يشهدها المشهد الإعلامي المعاصر، تبرز الحاجة إلى إعداد قيادات قادرة على إدارة التغيير والتعامل مع التحديات بمرونة وكفاءة عالية. وانطلاقًا من هذه الأهمية، يأتي هذا المساق بعنوان "القيادة في المؤسسات الإعلامية"، ليزوّد الدارسين بالمعارف النظرية والمهارات التطبيقية والقيم المهنية المرتبطة بمفاهيم القيادة وأساليبها المعاصرة، إلى جانب التعرف على أبرز النظريات والنماذج القيادية الملائمة لطبيعة العمل الإعلامي. يهدف المساق إلى تأهيل الكوادر الإعلامية لتمارس دورًا قياديًا فاعلًا يسهم في تطوير بيئة العمل الإعلامي وتحقيق التميز المؤسسي، سائلين الله - عز وجل - أن يكون هذا العلم نافعًا ومثمرًا في ميدان الممارسة الإعلامية.',
            ],
            [
                'instructor_name' => 'د. علاء صالح',
                'instructor_description' => 'استشاري تدريب وتطوير قيادي',
                'instructor_image' => 'https://api.ofuq.academy/storage/inst/dr.alaa-saleh.jpg',
                'title' => 'الجدارات والكفاءات الإدارية للقائد الإعلامي',
                'category_name' => 'القيادة والتطوير',
                'is_featured' => true,
                'course_description' => 'يشهد الحقل الإعلامي في العصر الراهن تحولات متسارعة بفعل التطور التكنولوجي والتغيرات الاتصالية المتلاحقة، مما ألقى على عاتق القادة الإعلاميين مسؤوليات متزايدة تتطلب امتلاك منظومة متكاملة من الجدارات والكفاءات الإدارية المتقدمة. ولم يعد الدور القيادي في المؤسسات الإعلامية مقتصرًا على إدارة العمليات اليومية، بل أصبح يستلزم قدرة عالية على التخطيط التشغيلي، والتواصل الفعّال، واتخاذ القرارات السليمة في بيئات عمل ديناميكية ومعقدة. يهدف هذا المساق إلى تزويد المشاركين بمجموعة من المهارات الإدارية والقيادية الضرورية، بما في ذلك إدارة الوقت والاجتماعات، وتفعيل فرق العمل، وتبني التفكير العلمي في حل المشكلات، بالإضافة إلى تطوير القدرات الاستراتيجية في اتخاذ القرارات الفعّالة. ويُعد هذا المساق خطوة أساسية نحو بناء قيادات إعلامية قادرة على مواكبة التحديات، ورفع كفاءة الأداء المؤسسي في مختلف البيئات الإعلامية.',
            ],
            [
                'instructor_name' => 'د. أشرف البهي',
                'instructor_description' => 'خبير التسويق والعلاقات العامة',
                'instructor_image' => 'https://api.ofuq.academy/storage/inst/dr.ashraf-elbahy.jpg',
                'title' => 'اﻟﻌﻼﻗﺎت اﻟﻌﺎﻣﺔ واﻟﺘﺴﻮﻳﻖ وإدارة اﻟﻤﺆﺳﺴﺎت اﻹﻋﻼﻣﻴﺔ',
                'category_name' => 'التسويق والعلاقات العامة',
                'is_featured' => true,
                'course_description' => 'تُعدّ وظيفة العلاقات العامة ركيزة أساسية في نجاح أي مؤسسة أو منشأة، لما تؤديه من دور محوري في بناء الصورة الإيجابية وتعزيز السمعة المرموقة لدى الجمهور الداخلي والخارجي على حد سواء. فالعلاقات العامة ليست مجرد نشاط اتصالي، بل هي منظومة متكاملة تهدف إلى ترسيخ الثقة المتبادلة بين المؤسسة ومحيطها عبر تقديم المعلومات الدقيقة والشفافة، وتعزيز روح الانتماء والتعاون بين العاملين، وتوثيق الصلات مع المجتمع. يسعى هذا المساق إلى تمكين الدارسين من فهم المفاهيم النظرية والعملية للعلاقات العامة، واستيعاب دورها في رفع كفاءة الأداء المؤسسي، وتحسين الصورة الذهنية للمنظمات، وتفعيل الاتصال الداخلي والخارجي بما يخدم الأهداف الاستراتيجية. كما يهدف إلى تنمية مهارات الطلبة في تخطيط وتنفيذ الأنشطة الاتصالية والإعلامية، وإعدادهم لتولي مهام العلاقات العامة في المؤسسات بمهنية عالية. ويُعد هذا المساق مدخلاً متكاملاً يجمع بين الأسس النظرية والممارسات التطبيقية للعلاقات العامة والتسويق وإدارة المؤسسات الإعلامية، بما يؤهل المشاركين لاكتساب المهارات اللازمة لممارسة هذا الدور الحيوي بفاعلية في البيئات المهنية المتنوعة.',
            ],
            [
                'instructor_name' => 'د. أشرف الشامي',
                'instructor_description' => 'أستاذ الإعلام جامعة الأهرام الكندية',
                'instructor_image' => 'https://api.ofuq.academy/storage/inst/dr.ashraf-el-shamy.jpg',
                'title' => 'استشراف المستقبل',
                'category_name' => 'استشراف المستقبل',
                'is_featured' => true,
                'course_description' => 'يُعد هذا المساق من المساقات الأساسية التي تهدف إلى تزويد الطلبة بالمعارف والمفاهيم الحديثة المرتبطة باستشراف المستقبل في المؤسسات، مع التركيز على المؤسسات الإعلامية ودورها المحوري في مواكبة التغيرات المتسارعة واستباقها. ويعرّف المساق الطلبة بمفهوم الاستشراف كأحد أدوات التخطيط الاستراتيجي، من خلال دراسة الاتجاهات المستقبلية، وتحليل البيئات الداخلية والخارجية، واكتشاف الفرص والتحديات المحتملة، بما يمكّن القادة وصنّاع القرار من وضع تصورات واستراتيجيات فاعلة لمواجهة التغيرات المستقبلية. كما يهدف المساق إلى تنمية مهارات الطلبة في التفكير المستقبلي، واستخدام أدوات التحليل المستقبلي، وبناء السيناريوهات، بما يسهم في إعداد كوادر قادرة على اتخاذ قرارات مستنيرة تحقق التنمية المستدامة لمؤسساتهم، وتُعزز قدرتها التنافسية في بيئات عمل متغيرة. ويُقدم المساق مزيجًا من الإطار النظري والتطبيقات العملية، من خلال محاضرات، وحلقات نقاش، ودراسات حالة، وتمارين تطبيقية، لتزويد الطلبة بخبرة معرفية وعملية متكاملة في هذا المجال الحيوي.',
            ],
            [
                'instructor_name' => 'الأستاذ الدكتور/ أشرف رجب الريدي',
                'instructor_description' => 'أستاذ تعليم الإعلام بجامعة المنيا - مدرب معتمد من المجلس الأعلى للجامعات بمجال تكنولوجيا المعلومات',
                'instructor_image' => 'https://api.ofuq.academy/storage/inst/dr.ashraf-ragab-elredy.jpg',
                'title' => 'التخطيط الاستراتيجي والابتكار في المؤسسات الإعلامية',
                'category_name' => 'التخطيط الاستراتيجي',
                'is_featured' => true,
                'course_description' => 'يُعد التخطيط الاستراتيجي في مجال الإعلام أحد المرتكزات الأساسية لتحقيق التنمية المستدامة وتعزيز الأداء المؤسسي. فقد أصبح التفكير الابتكاري عنصرًا محوريًا في بناء الرؤى والاستراتيجيات الإعلامية، نظرًا لدوره الحيوي في تطوير بيئات العمل الإعلامي واستجابتها للتحولات المجتمعية والتقنية المتسارعة. تشير الدراسات الحديثة إلى وجود علاقة تبادلية وثيقة بين الإعلام والتنمية، حيث يسهم الإعلام الواعي والمخطط له بفاعلية في توجيه الرأي العام ودعم القيم التنموية، بينما تؤثر مخرجات التنمية بدورها في تطور الأداء الإعلامي وجودته. وانطلاقًا من هذه العلاقة، تبرز الحاجة إلى تمكين القيادات الإعلامية من وضع خطط استراتيجية مبنية على أسس علمية ومنهجية، قادرة على إنتاج حملات إعلامية تنموية تُحدث أثرًا إيجابيًا مستدامًا في المجتمع، مع تجاوز التحديات الثقافية والتبعية الإعلامية التي تواجه العديد من الدول الإفريقية والنامية. يهدف هذا المساق، المعنون بـ "التخطيط الاستراتيجي والابتكار في المؤسسات الإعلامية"، إلى تزويد الدارسين بالمعارف النظرية والمهارات التطبيقية والقيم المهنية اللازمة لفهم منهجيات التخطيط الاستراتيجي، وتطبيقها في تصميم وتنفيذ خطط إعلامية مبتكرة تسهم في تحقيق التنمية وتعزيز كفاءة المؤسسات الإعلامية في العصر الرقمي.',
            ],
            [
                'instructor_name' => 'د. فوزي عبدالرحمن',
                'instructor_description' => 'أستاذ الإعلام بمعهد البحوث والدراسات التابع لجامعة الدول العربية',
                'instructor_image' => 'https://api.ofuq.academy/storage/inst/dr.fawzy-abdelrhman.jpg',
                'title' => 'أخلاقيات الإعلام وآداب المهنة',
                'category_name' => 'أخلاقيات الإعلام',
                'is_featured' => true,
                // No description provided by user
            ],
            [
                'instructor_name' => 'د. حماد الرمحي',
                'instructor_description' => 'خبير تحليل اقتصاديات المؤسسات الإعلامية',
                'instructor_image' => 'https://api.ofuq.academy/storage/inst/dr.hamad-elramhy.jpg',
                'title' => 'إدارة اقتصاديات المؤسسات الإعلامية',
                'category_name' => 'اقتصاديات الإعلام',
                'course_description' => 'يهدف مساق إدارة اقتصاديات المؤسسات الإعلامية إلى تزويد الطلبة بفهم عميق لطبيعة العملية الاقتصادية داخل المؤسسات الإعلامية، بوصفها أحد الفروع التطبيقية لعلم الاقتصاد الذي يركّز على دراسة الإنتاج، والتوزيع، والاستهلاك في مجال الإعلام. ويتناول المساق مفهوم الإنتاج الإعلامي بوصفه عملية تحويل الموارد إلى منتجات وخدمات إعلامية، مثل الصحف والمجلات والبرامج التلفزيونية والإذاعية، مع التركيز على المراحل المختلفة للإنتاج، وآليات تنظيم العمل، والتنسيق بين العناصر الفنية والإدارية، وإدارة الميزانيات والموارد المتاحة بكفاءة. كما يسلّط المساق الضوء على التحديات الاقتصادية التي تواجه المؤسسات الإعلامية، وأهمية التخطيط المالي والإداري لضمان استدامة العمل الإعلامي وجودته. ويجمع هذا المساق بين الإطار النظري والممارسات العملية، بهدف تمكين الطلبة من اكتساب المعارف والمهارات والقيم اللازمة لإدارة الموارد الإعلامية بكفاءة عالية، بما يعزز قدرتهم على العمل في بيئات إعلامية تنافسية ومتغيرة.',
            ],
            [
                'instructor_name' => 'د. مطهر الريدة',
                'instructor_description' => 'محاضر بكلية الإعلام جامعة الأزهر',
                'instructor_image' => 'https://api.ofuq.academy/storage/inst/dr.mathar-elredah.jpg',
                'title' => 'إدارة المعرفة في المؤسسات الإعلامية',
                'category_name' => 'إدارة المعرفة',
                'course_description' => 'تُعدّ المعرفة في العصر الحديث المحرك الرئيس للتقدم الإنساني ورافعة التنمية في مختلف المجالات، إذ أصبحت المورد الأهم للدول والمؤسسات على حدٍّ سواء. فقد تجاوزت المعرفة مفهومها التقليدي القائم على جمع المعلومات إلى كونها نظامًا متكاملًا لإنتاج القيم المضافة وصناعة القرارات الرشيدة، حتى غدت أساسًا لاقتصاد عالمي جديد يقوم على الابتكار والذكاء والتكنولوجيا. وفي ظل هذا التحول المعرفي، برز قطاع الإعلام بوصفه أحد أكثر القطاعات تأثرًا بإدارة المعرفة وتطبيقاتها، لما تمثله من أهمية في تطوير المحتوى الإعلامي، ورفع كفاءة الأداء المؤسسي، وتعزيز القدرة التنافسية للمؤسسات الإعلامية. فنجاح أي رسالة إعلامية مرهون بقدرتها على توظيف المعرفة في تحديد الجمهور المستهدف، وصياغة الرسائل المناسبة، وإدارة البيانات والمعلومات بصورة علمية دقيقة. يسعى هذا المساق إلى تزويد الطلبة بالأسس النظرية والتطبيقية لإدارة المعرفة في السياق الإعلامي، وتمكينهم من فهم آليات استثمارها في تطوير المحتوى وتحسين الأداء المؤسسي داخل المؤسسات الإعلامية. كما يركّز على تحليل تجارب تطبيقية ودراسات حالة توضّح دور إدارة المعرفة في رفع كفاءة العمل الإعلامي وجودته، وبناء ثقافة تنظيمية قائمة على التعلم المستمر والابتكار. ويهدف المساق في مجمله إلى تأهيل الدارسين لاكتساب المهارات والمعارف اللازمة لتصميم وتنفيذ استراتيجيات فعالة لإدارة المعرفة في المؤسسات الإعلامية، بما يسهم في تطوير أدائها وتحقيق أهدافها في بيئة إعلامية تتسم بسرعة التغيير والتنافسية العالية.',
            ],
            [
                'instructor_name' => 'د. محمد عبادي',
                'instructor_description' => 'خبير الإعلام وتحليل السياسات الدولية',
                'instructor_image' => 'https://api.ofuq.academy/storage/inst/dr.mohamed-abady.jpg',
                'title' => 'حراسة البوابة والأجندة الإعلامية للإعلام الرقمي',
                'category_name' => 'الإعلام الرقمي',
                'course_description' => 'يهدف مساق حراسة البوابة والأجندة الإعلامية إلى تعريف الطلبة بالمفاهيم والنظريات الأساسية المرتبطة بدور الصحفيين والمؤسسات الإعلامية في انتقاء المعلومات، وصياغة الرسائل الإعلامية، وتوجيه الأجندة العامة من خلال ما يُعرف بحراسة البوابة. ويركّز المساق على تحليل الوظائف التحريرية التي يقوم بها حارس البوابة الإعلامية، مثل جمع الأخبار، وتحريرها، وترتيبها، وتفسيرها، وتأثير ذلك في تشكيل البيئة الإعلامية واتجاهات الجمهور، خاصة في ظل التحولات التي يشهدها الإعلام الرقمي. كما يتناول المساق أبعاد هذا الدور في المؤسسات الإعلامية الحكومية والخاصة، ويُبرز علاقته بالسياسات التحريرية وصناعة المحتوى الإعلامي، إلى جانب دراسة النماذج التطبيقية لمعالجة الأجندة الإعلامية في سياقات مختلفة، بما في ذلك الإعلام الموجّه إلى مناطق معينة مثل إفريقيا. ويهدف المساق إلى تزويد الطلبة بالمعارف النظرية والمهارات العملية التي تمكنهم من فهم آليات التأثير الإعلامي، وتحليل السياسات التحريرية، وإنتاج محتوى إعلامي واعٍ وفعّال.',
            ],
            [
                'instructor_name' => 'د. محمد عابدين',
                'instructor_description' => 'خبير إعلامي ورئيس تحرير سابق بقناة النيل الثقافية',
                'instructor_image' => 'https://api.ofuq.academy/storage/inst/dr.mohamed-abdeen.jpg',
                'title' => 'نماذج تطبيقية',
                'category_name' => 'النماذج التطبيقية',
                'course_description' => 'في ظل التحولات السريعة التي يشهدها قطاع الإعلام، لم يعد كافيًا أن يقتصر إعداد القادة على المفاهيم الإدارية العامة، بل أصبح من الضروري تدريبهم على الممارسات الواقعية وأساليب القيادة الميدانية التي تواكب بيئة العمل الإعلامي المتغيرة. يهدف هذا المساق إلى تمكين الدارسين من تطبيق المفاهيم القيادية في مواقف عملية حقيقية، من خلال دراسات حالة، وتمارين محاكاة، ومشروعات جماعية تحاكي واقع المؤسسات الإعلامية. كما يُعنى المساق بتطوير مهارات اتخاذ القرار، وإدارة الأزمات، والتخطيط الاستراتيجي الإعلامي، وبناء فرق العمل الفعّالة داخل المؤسسات. ويُعد هذا المساق مكمّلًا للمقررات النظرية في القيادة الإعلامية، إذ يوفّر تجربة تعليمية تفاعلية تُنمّي مهارات التفكير النقدي والإبداعي لدى الدارسين، وتُعزّز قدرتهم على التحوّل من الفهم النظري إلى التطبيق العملي القيادي في بيئات إعلامية حقيقية ومتنوعة.',
            ],
            [
                'instructor_name' => 'د. محمد علوان',
                'instructor_description' => 'خبير التطوير التنظيمي والإعلام القيادي',
                'instructor_image' => 'https://api.ofuq.academy/storage/inst/dr.mohamed-alwaan.jpg',
                'title' => 'التطور التنظيمي للمؤسسات الإعلامية',
                'category_name' => 'التطوير التنظيمي',
                'course_description' => 'تُعد الإدارة الإعلامية وتطورها أحد المحاور الرئيسة لفهم الدور الحيوي الذي يؤديه الإعلام في حياة المجتمعات المعاصرة. فلم يعد الإعلام مجرد وسيلة لنقل الرسائل أو نشر الثقافة، بل أصبح صناعة متقدمة تتقاطع فيها المعرفة العلمية والتكنولوجيا الحديثة مع الإدارة الاحترافية. وفي ظل التحولات المتسارعة التي يشهدها العالم في مجالات التقنية والاتصال، بات من الضروري أن تواكب المؤسسات الإعلامية هذا التقدم من خلال تطوير هياكلها التنظيمية، وتحديث آليات عملها، وبناء كوادرها المهنية القادرة على قيادة التغيير. يهدف هذا المساق إلى تزويد الطلبة بالمعارف والمفاهيم الأساسية المتعلقة بالتطور التنظيمي للمؤسسات الإعلامية، وفهم الأسس العلمية والإدارية التي تمكّن هذه المؤسسات من تحقيق أهدافها بكفاءة وفاعلية في بيئة إعلامية متغيرة. كما يسعى المساق إلى تنمية مهارات تحليل الواقع التنظيمي، والتخطيط للتطوير المؤسسي، بما يعزز من قدرة الطلبة على الإسهام مستقبلاً في إدارة وتطوير المؤسسات الإعلامية في مختلف القطاعات.',
            ],
            [
                'instructor_name' => '—', // Placeholder
                'instructor_description' => 'سيتم تحديث التفاصيل قريبًا',
                'instructor_image' => 'https://api.ofuq.academy/storage/inst/dr.mohamed-el-meshtawe.jpg', // Placeholder image
                'title' => 'دورة قيد التحضير',
                'category_name' => 'عام',
                'course_description' => 'هذا الكورس قيد التحضير حاليًا وسيتم توفير تفاصيله قريبًا.',
            ],
            [
                'instructor_name' => 'د. محمد المشتاوي',
                'instructor_description' => 'خبير الإعلام الرقمي والتحول الذكي',
                'instructor_image' => 'https://api.ofuq.academy/storage/inst/dr.mohamed-sha\'t.jpg',
                'title' => 'إدارة الإعلام والتحول الرقمي',
                'category_name' => 'الإعلام الرقمي',
                'course_description' => 'يشهد العالم المعاصر تحولات عميقة بفعل التطورات المتسارعة في تكنولوجيا الاتصال والمعلومات، والتي أعادت تشكيل البيئة الاتصالية وبناء المجتمعات على أسس رقمية جديدة. وقد فرض هذا الواقع على المؤسسات الإعلامية تحديًا مزدوجًا يتمثل في المحافظة على الأصالة والهوية الإعلامية من جهة، والتكيف مع معطيات العصر الرقمي ومتطلباته من جهة أخرى. ويركز هذا المساق على تحليل العلاقة بين الإعلام والتحول الرقمي، من خلال دراسة التأثيرات البنيوية والتقنية والتنظيمية التي أحدثتها الثورة الرقمية في بيئات العمل الإعلامي. كما يتناول أنماط تفاعل المؤسسات الإعلامية مع التحولات الرقمية، سواء من حيث تبني الأدوات الرقمية وتطوير المهارات، أو من حيث التحديات التي تواجهها في مجالات الإدارة والإنتاج والتوزيع والتواصل مع الجمهور. ويهدف المساق إلى تمكين الطلبة من فهم الأسس النظرية للتحول الرقمي في الإعلام، واكتساب مهارات التعامل مع البيئة الرقمية بفاعلية، وتطوير القدرة على توظيف التكنولوجيا الحديثة لخدمة الرسالة الإعلامية وتعزيز التنافسية في العصر الرقمي.',
            ],
            // New course not in user's list, but found a description for it.
            [
                'instructor_name' => 'فريق أفق',
                'instructor_description' => 'خبراء في الإعلام الرقمي',
                'instructor_image' => null,
                'title' => 'تحديات وفرص الإعلام الرقمي الإفريقي',
                'category_name' => 'الإعلام الرقمي',
                'course_description' => 'يشهد العالم المعاصر تحولًا جذريًا في أنماط الاتصال والتواصل بفعل التطور المتسارع في الوسائط الرقمية، التي أصبحت محورًا أساسيًا في نشر المعلومات والترفيه والتفاعل الاجتماعي. فقد أسهمت المنصات الرقمية، وعلى رأسها وسائل التواصل الاجتماعي وخدمات البث، في إعادة تشكيل المشهد الإعلامي العالمي من حيث إنتاج المحتوى واستهلاكه والتفاعل معه. تُعد الرقمنة الإعلامية اليوم من أبرز الظواهر المؤثرة في قطاع الإعلام، لما تمتلكه من أدوات وتقنيات تحتاج إلى توظيف فعّال يعزز من جودة الأداء الإعلامي عبر المنصات المختلفة. وانطلاقًا من أهمية هذا التحول، يتناول هذا المساق الأكاديمي تحليل واقع الرقمنة الإعلامية في إفريقيا، مسلطًا الضوء على إيجابياتها وسلبياتها، وعلى التحديات والفرص التي تتيحها في القارة السمراء. يهدف هذا المساق، بعنوان "تحديات وفرص الإعلام الرقمي الإفريقي"، إلى تمكين الدارسين من اكتساب المعارف والمهارات والقيم المهنية اللازمة لفهم التحولات الرقمية في المجال الإعلامي، وتوظيفها بشكلٍ فعّال داخل المؤسسات الإعلامية، بما يسهم في تطوير الأداء والابتكار في البيئة الرقمية المعاصرة.',
            ]
        ];

        foreach ($courses as $data) {
            $category = CategoryOfCourse::firstOrCreate(['name' => $data['category_name']]);
            $instructorImg = $this->normalizeImagePath($data['instructor_image'] ?? null);
            $instructor = Instructors::firstOrCreate(
                ['name' => $data['instructor_name']],
                [
                    'title' => $data['instructor_description'] ?? '',
                    'bio'   => $data['instructor_description'] ?? '',
                    'image' => $instructorImg,
                ]
            );

            $base = [
                // ✅ Use the new detailed description, with a fallback
                'description'      => $data['course_description'] ?? 'هذا الكورس متاح للعرض فقط، وسيتم تحديث المحتوى لاحقاً.',
                'instructor_id'    => $instructor->id,
                'category_id'      => $category->id,
                'cover_image'      => $instructorImg,
                'price'            => 0.00,
                'is_free'          => true,
                'is_published'     => true,
                'duration'         => 0,
                'rating'           => 4.7,
                'students_count'   => rand(120, 450),
                'reviews_count'    => rand(10, 80),
                'name_instructor'  => $data['instructor_name'],
                'title_instructor' => $data['instructor_description'] ?? '',
                'bio_instructor'   => $data['instructor_description'] ?? '',
                'image_instructor' => $instructorImg,
            ];

            if (Schema::hasColumn('courses', 'slug')) {
                $base['slug'] = Str::slug($data['title']).'-'.Str::lower(Str::random(6));
            }

            $course = Course::updateOrCreate(
                ['title' => $data['title']],
                $base
            );

            if (!empty($data['is_featured']) && class_exists(\App\Models\FeaturedCourse::class)) {
                \App\Models\FeaturedCourse::updateOrCreate(
                    ['course_id' => $course->id],
                    ['priority' => 1, 'is_active' => true]
                );
            }

            // ✅ Build full content for Dr. Mohamed Abady's course
            if ($data['title'] === 'حراسة البوابة والأجندة الإعلامية للإعلام الرقمي') {
                $this->command->info("-> Building full content for '{$course->title}'...");
                
                // Use the detailed description from the user
                $course->update(['description' => $data['course_description']]);

                $chapter = $course->chapters()->updateOrCreate(
                    ['title' => 'المحتوي'],
                    ['description' => 'الوحدة الأساسية التي تغطي محاضرات الكورس.', 'order' => 1]
                );

                $lesson1 = $chapter->lessons()->updateOrCreate(
                    ['title' => 'المحاضرة الأولى: مقدمة في نظرية حراسة البوابة'],
                    [
                        'content' => 'محتوى الدرس متاح عبر الفيديو. سيتم إضافة نص لاحقًا.',
                        'video_url' => 'https://player.mediadelivery.net/embed/513468/9bbe49f3-0d0c-4e3e-94dd-c78508697558',
                        'order' => 1,
                        'is_visible' => true
                    ]
                );
                $quiz1 = $lesson1->quiz()->updateOrCreate(['title' => 'اختبار المحاضرة الأولى']);
                $quiz1->questions()->delete(); // Clear old questions before seeding
                $quiz1->questions()->createMany([
                    ['question' => 'ما هو المفهوم الأساسي لنظرية حراسة البوابة الإعلامية؟', 'options' => json_encode(['عملية فلترة الأخبار', 'تأثير الإعلام', 'تفاعل الجمهور', 'أساليب الإعلان']), 'correct_answer' => 'عملية فلترة الأخبار'],
                    ['question' => 'من يعتبر "حارس بوابة" نموذجي في الإعلام التقليدي؟', 'options' => json_encode(['المحرر', 'الجمهور', 'المُعلن', 'الحكومة']), 'correct_answer' => 'المحرر'],
                    ['question' => 'كيف أثر الإعلام الرقمي على دور حارس البوابة؟', 'options' => json_encode(['أضعف الدور التقليدي', 'عزز الدور التقليدي', 'لم يؤثر', 'جعله أكثر تكلفة']), 'correct_answer' => 'أضعف الدور التقليدي'],
                ]);

                $lesson2 = $chapter->lessons()->updateOrCreate(
                    ['title' => 'المحاضرة الثانية: ترتيب الأولويات والأجندة الإعلامية'],
                    [
                        'content' => 'محتوى الدرس متاح عبر الفيديو. سيتم إضافة نص لاحقًا.',
                        'video_url' => 'https://player.mediadelivery.net/embed/513468/d44b0f53-1aa6-40a8-b9f3-5839c0c74b00',
                        'order' => 2,
                        'is_visible' => false
                    ]
                );
                $quiz2 = $lesson2->quiz()->updateOrCreate(['title' => 'اختبار المحاضرة الثانية']);
                $quiz2->questions()->delete(); // Clear old questions
                $quiz2->questions()->createMany([
                    ['question' => 'ماذا تقترح نظرية ترتيب الأولويات؟', 'options' => json_encode(['الإعلام يحدد بماذا نفكر', 'الإعلام يعكس الواقع', 'الجمهور يحدد الأجندة', 'الأجندة تركز على السياسة']), 'correct_answer' => 'الإعلام يحدد بماذا نفكر'],
                    ['question' => 'ما هو "المستوى الثاني" من النظرية؟', 'options' => json_encode(['التأثير على كيفية التفكير', 'تحديد القضايا المهمة', 'قياس رد الفعل', 'التوزيع الجغرافي']), 'correct_answer' => 'التأثير على كيفية التفكير'],
                    ['question' => 'أي من التالي مثال على ترتيب الأولويات الرقمي؟', 'options' => json_encode(['هاشتاج تويتر', 'جدول الأخبار', 'عناوين الصحف', 'إعلانات الراديو']), 'correct_answer' => 'هاشتاج تويتر'],
                ]);

                // --- المحاضرة الثالثة ---
                $lesson3 = $chapter->lessons()->updateOrCreate(
                    ['title' => 'المحاضرة الثالثة'],
                    [
                        'content' => 'محتوى الدرس متاح عبر الفيديو. سيتم إضافة نص لاحقًا.',
                        'video_url' => 'https://player.mediadelivery.net/embed/513468/e37c43c7-b332-47bf-a043-83705c90b4f0',
                        'order' => 3,
                        'is_visible' => false
                    ]
                );
                $quiz3 = $lesson3->quiz()->updateOrCreate(['title' => 'اختبار المحاضرة الثالثة']);
                $quiz3->questions()->delete();
                $quiz3->questions()->createMany([
                    ['question' => 'ما الفرق بين حراسة البوابة التقليدية والرقمية؟', 'options' => json_encode(['الرقمية تعتمد على الخوارزميات', 'لا يوجد فرق', 'التقليدية تعتمد على الجمهور فقط', 'الرقمية تُقلّل التنوع الإعلامي دائمًا']), 'correct_answer' => 'الرقمية تعتمد على الخوارزميات'],
                    ['question' => 'أي من التالي يمثل مثالًا لحارس بوابة رقمي؟', 'options' => json_encode(['خوارزمية منصة التواصل', 'رئيس التحرير فقط', 'المُعلن دائمًا', 'المراسل الميداني']), 'correct_answer' => 'خوارزمية منصة التواصل'],
                    ['question' => 'كيف تُؤثر التخصيصات الشخصية على وصول المحتوى؟', 'options' => json_encode(['تحدّ من التنوع المعلوماتي', 'ترفع الحياد دائمًا', 'تلغي الحاجة للأجندة الإعلامية', 'تزيد عدد الكلمات في المقال']), 'correct_answer' => 'تحدّ من التنوع المعلوماتي'],
                ]);

                // --- المحاضرة الرابعة ---
                $lesson4 = $chapter->lessons()->updateOrCreate(
                    ['title' => 'المحاضرة الرابعة'],
                    [
                        'content' => 'محتوى الدرس متاح عبر الفيديو. سيتم إضافة نص لاحقًا.',
                        'video_url' => 'https://player.mediadelivery.net/embed/513468/7d4017b4-566c-44ab-81e8-03f4450ad93d',
                        'order' => 4,
                        'is_visible' => false
                    ]
                );
                $quiz4 = $lesson4->quiz()->updateOrCreate(['title' => 'اختبار المحاضرة الرابعة']);
                $quiz4->questions()->delete();
                $quiz4->questions()->createMany([
                    ['question' => 'أي من العوامل يؤثر في قرارات حارس البوابة؟', 'options' => json_encode(['السياسة التحريرية', 'الطقس', 'الألوان المستخدمة', 'عدد الصفحات']), 'correct_answer' => 'السياسة التحريرية'],
                    ['question' => 'ما المقصود بعتبات النشر؟', 'options' => json_encode(['المعايير لتحديد النشر', 'عدد الحروف في الخبر', 'سعر الإعلان', 'نوع الورق المستخدم']), 'correct_answer' => 'المعايير لتحديد النشر'],
                    ['question' => 'كيف يغيّر ضغط الوقت من قرارات الاختيار؟', 'options' => json_encode(['يزيد الاعتماد على المصادر السريعة', 'يعطل النشر تمامًا', 'يلغي الأجندة الإعلامية', 'لا تأثير له']), 'correct_answer' => 'يزيد الاعتماد على المصادر السريعة'],
                ]);

                // --- المحاضرة الخامسة ---
                $lesson5 = $chapter->lessons()->updateOrCreate(
                    ['title' => 'المحاضرة الخامسة'],
                    [
                        'content' => 'محتوى الدرس متاح عبر الفيديو. سيتم إضافة نص لاحقًا.',
                        'video_url' => 'https://player.mediadelivery.net/embed/513468/788db910-bbf3-4176-b128-19ef7d25c36e',
                        'order' => 5,
                        'is_visible' => false
                    ]
                );
                $quiz5 = $lesson5->quiz()->updateOrCreate(['title' => 'اختبار المحاضرة الخامسة']);
                $quiz5->questions()->delete();
                $quiz5->questions()->createMany([
                    ['question' => 'كيف تؤثر الأجندة الإعلامية على الرأي العام؟', 'options' => json_encode(['ترفع أهمية قضايا معينة', 'تزيد عدد القنوات', 'تقلل من الإعلانات', 'تحسن جودة الورق']), 'correct_answer' => 'ترفع أهمية قضايا معينة'],
                    ['question' => 'ما الفرق بين تحديد الأهمية وتحديد السمات؟', 'options' => json_encode(['الأهمية = ماذا نفكر فيه، السمات = كيف نفكر فيه', 'الأهمية = كيف نفكر فيه، السمات = ماذا نفكر فيه', 'لا فرق بينهما', 'كلاهما يتعلق بالإعلانات']), 'correct_answer' => 'الأهمية = ماذا نفكر فيه، السمات = كيف نفكر فيه'],
                    ['question' => 'أي مثال يوضح تأثير الأجندة؟', 'options' => json_encode(['زيادة التغطية لقضية بيئية', 'تغيير لون الشعار', 'خفض عدد الصفحات', 'تبديل نوع الخط']), 'correct_answer' => 'زيادة التغطية لقضية بيئية'],
                ]);

                // --- المحاضرة السادسة ---
                $lesson6 = $chapter->lessons()->updateOrCreate(
                    ['title' => 'المحاضرة السادسة'],
                    [
                        'content' => 'محتوى الدرس متاح عبر الفيديو. سيتم إضافة نص لاحقًا.',
                        'video_url' => 'https://player.mediadelivery.net/embed/513468/bf32a2f8-368f-4110-b8ac-9040c3478447',
                        'order' => 6,
                        'is_visible' => false
                    ]
                );
                $quiz6 = $lesson6->quiz()->updateOrCreate(['title' => 'اختبار المحاضرة السادسة']);
                $quiz6->questions()->delete();
                $quiz6->questions()->createMany([
                    ['question' => 'ما دور خوارزميات المنصات في ترتيب الأولويات؟', 'options' => json_encode(['ترتيب المحتوى بناءً على التفاعل', 'تحديد أسعار الاشتراك', 'زيادة سرعة الإنترنت', 'اختيار ألوان الصور']), 'correct_answer' => 'ترتيب المحتوى بناءً على التفاعل'],
                    ['question' => 'أي من التالي مثال على التخصيص الخوارزمي؟', 'options' => json_encode(['اقتراحات يوتيوب', 'عنوان الصحيفة', 'رقم الصفحة', 'اسم المذيع']), 'correct_answer' => 'اقتراحات يوتيوب'],
                    ['question' => 'ما المخاطر المرتبطة بفقاعات التصفية؟', 'options' => json_encode(['تضييق نطاق المعلومات', 'تحسين التنوع الإعلامي', 'زيادة المعرفة الشاملة', 'رفع جودة التغطية دائمًا']), 'correct_answer' => 'تضييق نطاق المعلومات'],
                ]);

                // --- المحاضرة السابعة ---
                $lesson7 = $chapter->lessons()->updateOrCreate(
                    ['title' => 'المحاضرة السابعة'],
                    [
                        'content' => 'محتوى الدرس متاح عبر الفيديو. سيتم إضافة نص لاحقًا.',
                        'video_url' => 'https://player.mediadelivery.net/embed/513468/8dc3140b-2e4c-47e4-bfe9-d0b38de44073',
                        'order' => 7,
                        'is_visible' => false
                    ]
                );
                $quiz7 = $lesson7->quiz()->updateOrCreate(['title' => 'اختبار المحاضرة السابعة']);
                $quiz7->questions()->delete();
                $quiz7->questions()->createMany([
                    ['question' => 'ما الخطوة الأولى في التحقق من الأخبار؟', 'options' => json_encode(['تحديد المصدر', 'تغيير العنوان', 'نشر الخبر فورًا', 'حذف الخبر']), 'correct_answer' => 'تحديد المصدر'],
                    ['question' => 'أي من الأدوات تساعد في كشف الصور المزيفة؟', 'options' => json_encode(['البحث العكسي للصور', 'تغيير دقة الشاشة', 'تقليل السطوع', 'تحرير النص']), 'correct_answer' => 'البحث العكسي للصور'],
                    ['question' => 'ما معيار أساسي لقياس موثوقية المصدر؟', 'options' => json_encode(['الشفافية والسجل السابق', 'عدد الكلمات', 'حجم الخط', 'اسم الصفحة']), 'correct_answer' => 'الشفافية والسجل السابق'],
                ]);

                // --- المحاضرة الثامنة ---
                $lesson8 = $chapter->lessons()->updateOrCreate(
                    ['title' => 'المحاضرة الثامنة'],
                    [
                        'content' => 'محتوى الدرس متاح عبر الفيديو. سيتم إضافة نص لاحقًا.',
                        'video_url' => 'https://player.mediadelivery.net/embed/513468/d8ee463e-a036-4387-b2cf-6ad2885c50f2',
                        'order' => 8,
                        'is_visible' => false
                    ]
                );
                $quiz8 = $lesson8->quiz()->updateOrCreate(['title' => 'اختبار المحاضرة الثامنة']);
                $quiz8->questions()->delete();
                $quiz8->questions()->createMany([
                    ['question' => 'ما المقصود بالتحيز التأكيدي؟', 'options' => json_encode(['ميل لتأكيد الآراء السابقة', 'زيادة الحياد في العرض', 'تحسين توازن التغطية', 'الاعتماد على مصادر متنوعة دائمًا']), 'correct_answer' => 'ميل لتأكيد الآراء السابقة'],
                    ['question' => 'أي من التالي مثال على إطار إعلامي؟', 'options' => json_encode(['وصف قضية باعتبارها مشكلة أمنية', 'تغيير لون الشعار', 'تقليل عدد الصور', 'رفع دقة الفيديو']), 'correct_answer' => 'وصف قضية باعتبارها مشكلة أمنية'],
                    ['question' => 'كيف يؤثر الإطار على الفهم؟', 'options' => json_encode(['يوجه التفسير والمعاني', 'يزيد عدد المشاهدات فورًا', 'يغيّر لغة المقال', 'يرفع زمن القراءة فقط']), 'correct_answer' => 'يوجه التفسير والمعاني'],
                ]);

                // --- المحاضرة التاسعة ---
                $lesson9 = $chapter->lessons()->updateOrCreate(
                    ['title' => 'المحاضرة التاسعة'],
                    [
                        'content' => 'محتوى الدرس متاح عبر الفيديو. سيتم إضافة نص لاحقًا.',
                        'video_url' => 'https://player.mediadelivery.net/embed/513468/7f2d6472-4b67-418a-b11d-aebec2da3ac5',
                        'order' => 9,
                        'is_visible' => false
                    ]
                );
                $quiz9 = $lesson9->quiz()->updateOrCreate(['title' => 'اختبار المحاضرة التاسعة']);
                $quiz9->questions()->delete();
                $quiz9->questions()->createMany([
                    ['question' => 'ما مؤشر مناسب لقياس تأثير التغطية الإعلامية؟', 'options' => json_encode(['حجم التفاعل الرقمي', 'لون الشعار', 'عدد الصفحات المطبوعة', 'نوع الخط']), 'correct_answer' => 'حجم التفاعل الرقمي'],
                    ['question' => 'أي من التالي مثال على تجربة تأثير الإعلام؟', 'options' => json_encode(['مقارنة سلوك مجموعتين بعد مشاهدة محتوى', 'تغيير عنوان مقال', 'اختيار قالب تصميم', 'رفع دقة الصورة']), 'correct_answer' => 'مقارنة سلوك مجموعتين بعد مشاهدة محتوى'],
                    ['question' => 'ما فائدة تحليل المعنويات (Sentiment Analysis)؟', 'options' => json_encode(['قياس نبرة المحتوى والاتجاه', 'تحديد سعر الإعلان', 'تحسين جودة الطباعة', 'تغيير لغة الموقع']), 'correct_answer' => 'قياس نبرة المحتوى والاتجاه'],
                ]);
                
                $this->command->info("-> Full content added successfully.");
            }
        }

        $this->command->info('✅ تمت إضافة/تحديث كل الكورسات بنجاح مع الأوصاف الجديدة.');
    }
}